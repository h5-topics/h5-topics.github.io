{"version":3,"file":"static/webpack/static\\development\\pages\\topic.js.9a3cf34d9ed45aa25d6c.hot-update.js","sources":["webpack:///./components/common/share.jsx","webpack:///./components/topic/message-list-item.jsx","webpack:///./node_modules/core-js/modules/_fails-is-regexp.js","webpack:///./node_modules/core-js/modules/_string-context.js","webpack:///./node_modules/core-js/modules/es6.regexp.match.js","webpack:///./node_modules/core-js/modules/es6.string.starts-with.js"],"sourcesContent":["\r\nvar isPC = !(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(navigator.userAgent))\r\n\r\nvar isiOS = !!(navigator.userAgent.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/))\r\n\r\nvar Share = function (ele) {\r\n  this.ele = ele\r\n}\r\n\r\nShare.init = function () {\r\n  var eles = document.querySelectorAll('[data-share]')\r\n  var i\r\n  var l = eles.length\r\n  for (i = 0; i < l; i++) {\r\n    eles[i].addEventListener('click', Share.add)\r\n  }\r\n}\r\n\r\nShare.add = function (ele) {\r\n  var target = ele.currentTarget || ele.srcElement\r\n  var share = new Share(target)\r\n  share.getShareData()\r\n}\r\n\r\nShare.prototype = {\r\n  constructor: Share,\r\n\r\n  getValue: function (attr) {\r\n    var val = this.ele.getAttribute('data-' + attr)\r\n    if (!val) return\r\n    // facebook hashtag\r\n    if (attr === 'hashtag') {\r\n      if (!val.startsWith('#')) {\r\n        val = '#' + val\r\n      }\r\n    }\r\n    return val\r\n  },\r\n\r\n  getShareData: function () {\r\n    var share = this.getValue('share').toLowerCase()\r\n    var shares = {\r\n      facebook: {\r\n        shareUrl: 'https://www.facebook.com/sharer/sharer.php',\r\n        // shareUrl: 'https://www.facebook.com/dialog/share',\r\n        params: {\r\n          u: this.getValue('url'),\r\n          hashtag: this.getValue('hashtag'),\r\n          title: this.getValue('title'),\r\n          description: this.getValue('description'),\r\n          quote: this.getValue('quote')\r\n          // app_id: 360406121199259,\r\n          // display: 'popup',\r\n          // redirect_uri: 'https://www.wps.com',\r\n          // href: this.getValue('url'),\r\n          // link: this.getValue('url')\r\n          // quote: this.getValue('title'),\r\n          // hashtag: this.getValue('hashtag')\r\n        }\r\n      },\r\n      messenger: {\r\n        shareUrl: isPC ? 'https://www.facebook.com/dialog/send' : 'fb-messenger://share',\r\n        params: isPC ? {\r\n          // u: this.getValue('url'),\r\n          hashtag: this.getValue('hashtag'),\r\n          title: this.getValue('title'),\r\n          description: this.getValue('description'),\r\n          quote: this.getValue('quote'),\r\n          app_id: 360406121199259,\r\n          display: 'popup',\r\n          redirect_uri: 'https://www.wps.com',\r\n          href: this.getValue('url'),\r\n          link: this.getValue('url')\r\n          // quote: this.getValue('title'),\r\n          // hashtag: this.getValue('hashtag')\r\n        } : {\r\n          app_id: 360406121199259,\r\n          link: this.getValue('url')\r\n        },\r\n        isLink: !isPC\r\n      },\r\n      twitter: {\r\n        shareUrl: 'https://twitter.com/intent/tweet/',\r\n        params: {\r\n          text: this.getValue('title'),\r\n          url: this.getValue('url'),\r\n          hashtags: this.getValue('hashtags'),\r\n          via: this.getValue('via')\r\n        }\r\n      },\r\n      whatsapp: {\r\n        shareUrl: isPC ? 'https://wa.me/' : 'whatsapp://send',\r\n        params: {\r\n          text: this.getValue('title') + ' ' + this.getValue('url')\r\n        },\r\n        isLink: !isPC\r\n      },\r\n      googleplus: {\r\n        shareUrl: 'https://plus.google.com/share',\r\n        params: {\r\n          url: this.getValue('url')\r\n        }\r\n      },\r\n      email: {\r\n        shareUrl: 'mailto:',\r\n        params: {\r\n          subject: this.getValue('subject'),\r\n          body: this.getValue('title') + '\\n' + this.getValue('url')\r\n        },\r\n        isLink: true\r\n      },\r\n      sms: {\r\n        shareUrl: (isiOS ? 'sms:// &body=' : 'sms:// ?body=') + this.getValue('title') + '\\n' + this.getValue('url'),\r\n        isLink: true\r\n      },\r\n      line: {\r\n        shareUrl: 'http://line.me/R/msg/text/?' + encodeURIComponent(this.getValue('title') + ' ' + this.getValue('url')),\r\n        isLink: true\r\n      },\r\n      hackernews: {\r\n        shareUrl: 'https://news.ycombinator.com/submitlink',\r\n        params: {\r\n          u: this.getValue('url'),\r\n          t: this.getValue('title')\r\n        }\r\n      },\r\n      linkedin: {\r\n        shareUrl: 'https://www.linkedin.com/shareArticle',\r\n        params: {\r\n          url: this.getValue('url'),\r\n          title: this.getValue('title'),\r\n          summary: this.getValue('summary'),\r\n          mini: true\r\n        }\r\n      },\r\n      vk: {\r\n        shareUrl: 'http://vk.com/share.php',\r\n        params: {\r\n          url: this.getValue('url'),\r\n          title: this.getValue('title'),\r\n          description: this.getValue('caption'),\r\n          image: this.getValue('image')\r\n        }\r\n      },\r\n      xing: {\r\n        shareUrl: 'https://www.xing.com/app/user',\r\n        params: {\r\n          'op': 'share',\r\n          'url': this.getValue('url'),\r\n          'title': this.getValue('title')\r\n        }\r\n      }\r\n    }\r\n    var s = shares[share]\r\n\r\n    if (s) {\r\n      s.width = this.getValue('width')\r\n      s.height = this.getValue('height')\r\n    }\r\n    return s !== undefined ? this.urlShare(s) : false\r\n  },\r\n\r\n  urlShare: function (share) {\r\n    var p = share.params || {}\r\n    var keys = Object.keys(p)\r\n    var i\r\n    var str = keys.length > 0 ? '?' : ''\r\n    for (i = 0; i < keys.length; i++) {\r\n      if (str !== '?') {\r\n        str += '&'\r\n      }\r\n      if (p[keys[i]]) {\r\n        str += keys[i] + '=' + encodeURIComponent(p[keys[i]])\r\n      }\r\n    }\r\n    share.shareUrl += str\r\n\r\n    if (!share.isLink) {\r\n      var popWidth = share.width || 600\r\n      var popHeight = share.height || 480\r\n      var left = window.innerWidth / 2 - popWidth / 2 + window.screenX\r\n      var top = window.innerHeight / 2 - popHeight / 2 + window.screenY\r\n      var popParams = 'scrollbars=no, width=' + popWidth + ', height=' + popHeight + ', top=' + top + ', left=' + left\r\n      var newWindow = window.open(share.shareUrl, '', popParams)\r\n\r\n      if (window.focus) {\r\n        newWindow.focus()\r\n      }\r\n    } else {\r\n      console.log(share.shareUrl)\r\n      window.location.href = share.shareUrl\r\n    }\r\n  }\r\n}\r\n\r\nexport default Share\r\n\r\n","import { useCallback, useState, useContext, useRef, useEffect } from 'react'\r\nimport share from '../common/share'\r\nimport { Context } from '.'\r\n\r\nconsole.log(share)\r\n\r\nconst useMessgaeStateHook = (message) => {\r\n  const [ up_count, setUpCount ] = useState(message.up_count)\r\n  const [ down_count, setDownCount ] = useState(message.down_count)\r\n\r\n  const getLocalState = useCallback(() => {\r\n    return localStorage.getItem('message_' + message.ID) || 'noset'\r\n  }, [])\r\n  const setLocalState = useCallback(state => {\r\n    localStorage.setItem('message_' + message.ID, state)\r\n  }, [])\r\n  const { setToast, setOpenedMessage } = useContext(Context)\r\n\r\n  const up = useCallback(() => {\r\n    const state = getLocalState()\r\n    switch(state) {\r\n      case 'noset':\r\n        setUpCount(up_count + 1)\r\n        setLocalState('up')\r\n      break\r\n      case 'up':\r\n        setUpCount(up_count - 1)\r\n        setLocalState('noset')\r\n      break\r\n      default:\r\n        setToast('already ' + state)\r\n    }\r\n  }, [ up_count ])\r\n  const down = useCallback(() => {\r\n    // fetch(`http://127.0.0.1:7001/api/messages/up?message=${ ID }`)\r\n    const state = getLocalState()\r\n    switch(state) {\r\n      case 'noset':\r\n        setDownCount(down_count + 1)\r\n        setLocalState('down')\r\n      break\r\n      case 'down':\r\n        setDownCount(down_count - 1)\r\n        setLocalState('noset')\r\n      break\r\n      default:\r\n        setToast('already ' + state)\r\n    }\r\n  }, [ down_count ])\r\n\r\n  const selectMessage = useCallback(() => {\r\n    setOpenedMessage(message)\r\n  }, [ message ])\r\n\r\n  return [\r\n    { ...message, up_count, down_count },\r\n    up, down, selectMessage\r\n]\r\n}\r\n\r\nconst stopPropagation = e => e.stopPropagation()\r\n\r\n\r\nconst MessageItem = ({ message }) => {\r\n  const [\r\n    { message_content, comment_count, up_count, down_count, whatsapp_share_count = 0 },\r\n    onUpClick, onDownClick, onCommentClick\r\n  ] = useMessgaeStateHook(message)\r\n\r\n  const extendMenu = useRef()\r\n  const openExtendMenu = useCallback(e => {\r\n    extendMenu.current.classList.toggle('show')\r\n    e.stopPropagation()\r\n  }, [])\r\n  const closeExtendMenu = useCallback(() => {\r\n    extendMenu.current.classList.remove('show')\r\n  }, [])\r\n  useEffect(() => {\r\n    document.body.addEventListener('click', closeExtendMenu)\r\n    return () => {\r\n      document.body.removeEventListener('click', closeExtendMenu)\r\n    }\r\n  }, [])\r\n\r\n  return <div className=\"message-item-wrapper\">\r\n    <div className=\"message-item-content\">{ message_content }</div>\r\n    <div className=\"message-item-extend\">\r\n      <div className=\"message-item-extend-piece\" style={ { textAlign: 'left' } }><a className=\"link with-whatsapp\" onClick={ onCommentClick }>{ whatsapp_share_count }</a></div>\r\n      <div className=\"message-item-extend-piece\"><a className=\"link with-comment\" onClick={ onCommentClick }>{ comment_count }</a></div>\r\n      <div className=\"message-item-extend-piece\"><a className=\"link with-like\" onClick={ onUpClick }>{ up_count }</a></div>\r\n      <div className=\"message-item-extend-piece\"><a className=\"link with-dislike\" onClick={ onDownClick }>{ down_count }</a></div>\r\n      <div className=\"message-item-extend-piece\" style={ { textAlign: 'right' } }>\r\n        <a className=\"link with-extend\" onClick={ openExtendMenu }/>\r\n        <div className=\"extend-menu\" ref={ extendMenu } onClickCapture={ stopPropagation }>\r\n          <a className=\"link with-facebook\" onClick={ closeExtendMenu }/>\r\n          <a className=\"link with-whatsapp\" onClick={ closeExtendMenu }/>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n}\r\n\r\nexport default MessageItem","var MATCH = require('./_wks')('match');\nmodule.exports = function (KEY) {\n  var re = /./;\n  try {\n    '/./'[KEY](re);\n  } catch (e) {\n    try {\n      re[MATCH] = false;\n      return !'/./'[KEY](re);\n    } catch (f) { /* empty */ }\n  } return true;\n};\n","// helper for String#{startsWith, endsWith, includes}\nvar isRegExp = require('./_is-regexp');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, searchString, NAME) {\n  if (isRegExp(searchString)) throw TypeError('String#' + NAME + \" doesn't accept regex!\");\n  return String(defined(that));\n};\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\n\n// @@match logic\nrequire('./_fix-re-wks')('match', 1, function (defined, MATCH, $match, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = defined(this);\n      var fn = regexp == undefined ? undefined : regexp[MATCH];\n      return fn !== undefined ? fn.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative($match, regexp, this);\n      if (res.done) return res.value;\n      var rx = anObject(regexp);\n      var S = String(this);\n      if (!rx.global) return regExpExec(rx, S);\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA;AAHA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAbA;AAcA;AACA;AAFA;AAIA;AAnBA;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAFA;AASA;AACA;AACA;AACA;AADA;AAGA;AALA;AAOA;AACA;AACA;AACA;AADA;AAFA;AAMA;AACA;AACA;AACA;AACA;AAFA;AAIA;AANA;AAQA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAFA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAFA;AASA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AAvGA;AAgHA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxKA;AA2KA;;;;;;;;;;;;;;;;;;;;;;;ACnMA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAAA;AAAA;AACA;AAWA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAVA;AAYA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AAVA;AAYA;AAEA;AACA;AACA;AAEA;AACA;AAAA;AADA;AAIA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;;;;;;;;;;;ACtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}